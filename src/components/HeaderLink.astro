---
import type { HTMLAttributes } from 'astro/types';

type Props = HTMLAttributes<'a'> & {
  mobile?: boolean;
};

const { href, class: className, mobile = false, ...props } = Astro.props;
const pathname = Astro.url.pathname.replace(import.meta.env.BASE_URL, '');
const subpath = pathname.match(/[^\/]+/g);
const isActive = href === pathname || href === '/' + (subpath?.[0] || '');

const baseClasses = mobile 
  ? 'block py-2 px-4 text-gray-700 hover:text-blue-600 hover:bg-gray-50 rounded-lg transition-colors duration-200'
  : 'text-gray-700 hover:text-blue-600 font-medium transition-colors duration-200 relative';

const activeClasses = mobile
  ? 'text-blue-600 bg-blue-50'
  : 'text-blue-600';
---

<a 
  href={href} 
  class:list={[
    baseClasses,
    { [activeClasses]: isActive },
    { 'is-active': isActive },
    className
  ]} 
  {...props}
>
  <slot />
  {!mobile && isActive && (
    <span class="absolute -bottom-1 left-0 w-full h-0.5 bg-blue-600"></span>
  )}
</a>
