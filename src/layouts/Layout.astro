---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import '../styles/global.css';
import '../styles/homepage-glass.css';

export interface Props {
  title: string;
  description?: string;
  image?: string;
  background?: string;
  noOverlay?: boolean;
  withOverlay?: boolean;
}

const { title, description = "Professionele installatie van airco, Quooker en waterontharders. BRL gecertificeerd met 15+ jaar ervaring.", image, background, noOverlay = false, withOverlay = false } = Astro.props;
---

<!DOCTYPE html>
<html lang="nl">
  <head>
    <BaseHead title={title} description={description} image={image} />
    
    <!-- Schema.org LocalBusiness Structured Data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "LocalBusiness",
        "@id": "https://www.technischeserviceassen.nl/#organization",
        "name": "Technische Service Assen",
        "alternateName": "Johan Oosting Technische Installaties",
        "description": "Professionele installatie van airco's, Quooker kokendwaterkranen en Delta waterontharders in Assen en omgeving. BRL-100 gecertificeerd met 15+ jaar ervaring.",
        "url": "https://www.technischeserviceassen.nl",
        "logo": "https://www.technischeserviceassen.nl/logo.png",
        "image": "https://www.technischeserviceassen.nl/assets/homepage/responsive/mitsubishi-1440w.avif",
        "telephone": "+31658980933",
        "email": "info@technischeserviceassen.nl",
        "priceRange": "€€",
        "address": {
          "@type": "PostalAddress",
          "streetAddress": "",
          "addressLocality": "Assen",
          "addressRegion": "Drenthe",
          "postalCode": "",
          "addressCountry": "NL"
        },
        "geo": {
          "@type": "GeoCoordinates",
          "latitude": "52.9925",
          "longitude": "6.5649"
        },
        "areaServed": [
          {
            "@type": "City",
            "name": "Assen"
          },
          {
            "@type": "State",
            "name": "Drenthe"
          },
          {
            "@type": "City",
            "name": "Groningen"
          }
        ],
        "openingHoursSpecification": [
          {
            "@type": "OpeningHoursSpecification",
            "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
            "opens": "08:00",
            "closes": "18:00"
          }
        ],
        "sameAs": [
          "https://www.facebook.com/technischeserviceassen",
          "https://www.linkedin.com/company/technische-service-assen"
        ],
        "hasOfferCatalog": {
          "@type": "OfferCatalog",
          "name": "Diensten",
          "itemListElement": [
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "Airco Installatie",
                "description": "Professionele installatie van airconditioning systemen. Daikin, Mitsubishi Heavy en Sinclair. BRL-100 gecertificeerd.",
                "provider": {
                  "@id": "https://www.technischeserviceassen.nl/#organization"
                },
                "areaServed": "Assen, Drenthe, Groningen"
              }
            },
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "Quooker Installatie",
                "description": "Professionele installatie van Quooker kokendwaterkranen. Alle modellen inclusief Flex en Cube.",
                "provider": {
                  "@id": "https://www.technischeserviceassen.nl/#organization"
                },
                "areaServed": "Assen, Drenthe, Groningen"
              }
            },
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "Waterontharder Installatie",
                "description": "Professionele installatie van Delta waterontharders. Belgische topkwaliteit en duurzaam.",
                "provider": {
                  "@id": "https://www.technischeserviceassen.nl/#organization"
                },
                "areaServed": "Assen, Drenthe, Groningen"
              }
            },
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "In Bedrijfstelling Airco",
                "description": "Professionele in bedrijfstelling van airco's en warmtepompen volgens F-gassen regelgeving.",
                "provider": {
                  "@id": "https://www.technischeserviceassen.nl/#organization"
                },
                "areaServed": "Assen, Drenthe, Groningen"
              }
            }
          ]
        },
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "4.9",
          "reviewCount": "87",
          "bestRating": "5",
          "worstRating": "1"
        },
        "founder": {
          "@type": "Person",
          "name": "Johan Oosting",
          "jobTitle": "Eigenaar"
        },
        "numberOfEmployees": {
          "@type": "QuantitativeValue",
          "value": "3"
        },
        "slogan": "Professionele installaties met 15+ jaar ervaring",
        "knowsAbout": [
          "Airconditioning installatie",
          "Quooker installatie",
          "Waterontharder installatie",
          "F-gassen certificering",
          "BRL-100 certificering",
          "Daikin airco",
          "Mitsubishi Heavy airco",
          "Sinclair airco",
          "Delta waterontharders",
          "Warmtepomp installatie"
        ],
        "paymentAccepted": ["Cash", "Bank Transfer", "iDEAL"],
        "currenciesAccepted": "EUR"
      }
    </script>
    
    <slot name="head" />
  </head>

  <body class={`hc-page ${noOverlay ? 'no-overlay' : ''} ${withOverlay ? 'with-overlay' : ''}`} style={background ? `--page-bg-image: url('${background}')` : undefined}>
    <Header />
    <main>
      <slot />
    </main>
    <Footer />
    
    <!-- Scroll to Top Button -->
    <button id="scroll-to-top" style="position: fixed; bottom: 5rem; right: 1rem;" class="z-40 opacity-0 pointer-events-none duration-300 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all" aria-label="Scroll naar boven">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18" />
      </svg>
    </button>
    
    <!-- Compact Cookie Consent Widget -->
    <div id="cookie-widget" class="fixed bottom-4 right-4 z-50">
      <div id="cookie-mini" class="flex items-center gap-2 bg-slate-800/90 backdrop-blur-sm text-slate-200 px-3 py-2 rounded-full shadow-lg text-xs cursor-pointer select-none">
        <span>Cookies</span>
        <button id="cookie-open" aria-label="Cookie instellingen" class="px-2 py-0.5 rounded bg-slate-700 hover:bg-slate-600 text-slate-200 text-xs">Instellen</button>
      </div>
      <div id="cookie-panel" class="hidden mt-2 w-72 bg-slate-900/95 backdrop-blur-sm border border-slate-700 rounded-xl shadow-xl p-4 text-slate-200 text-xs">
        <div class="flex items-start justify-between mb-2">
          <h2 class="font-semibold text-sm">Cookie Instellingen</h2>
          <button id="cookie-close" aria-label="Sluiten" class="text-slate-400 hover:text-slate-200">×</button>
        </div>
        <p class="text-slate-400 leading-relaxed mb-3">We gebruiken strikt noodzakelijke cookies. Sta analytics toe om de ervaring te verbeteren?</p>
        <div class="space-y-2 mb-3">
          <label class="flex items-center gap-2 text-slate-300">
            <input type="checkbox" id="cookie-analytics" class="accent-orange-500" />
            <span class="text-xs">Analytics inschakelen</span>
          </label>
        </div>
        <div class="flex gap-2">
          <button id="cookie-save" class="flex-1 btn btn-secondary text-xs py-2">Opslaan</button>
          <button id="cookie-accept-all" class="flex-1 btn btn-primary text-xs py-2">Alles</button>
        </div>
        <div class="mt-3 text-[10px] text-slate-500">
          <a href="/privacy" class="hover:text-orange-300 underline">Privacybeleid</a>
        </div>
      </div>
    </div>

    <script>
      // Simple cookie consent functionality
      document.addEventListener('DOMContentLoaded', function() {
        const widget = document.getElementById('cookie-widget');
        const mini = document.getElementById('cookie-mini');
        const panel = document.getElementById('cookie-panel');
        const openBtn = document.getElementById('cookie-open');
        const closeBtn = document.getElementById('cookie-close');
        const saveBtn = document.getElementById('cookie-save');
        const acceptAllBtn = document.getElementById('cookie-accept-all');
        const analyticsChk = document.getElementById('cookie-analytics');
        const analyticsInput = analyticsChk instanceof HTMLInputElement ? analyticsChk : null;

        const CONSENT_KEY = 'cookie-consent';
        const existing = localStorage.getItem(CONSENT_KEY);

        // If consent already given hide mini if all & analytics accepted
        if (existing === 'all') {
          if (analyticsInput) analyticsInput.checked = true;
          // keep minimal unobtrusive pill in case user wants to change
        } else if (existing === 'necessary') {
          if (analyticsInput) analyticsInput.checked = false;
        }

        function openPanel() { panel?.classList.remove('hidden'); mini?.classList.add('hidden'); }
        function closePanel() { panel?.classList.add('hidden'); mini?.classList.remove('hidden'); }
        openBtn?.addEventListener('click', openPanel);
        mini?.addEventListener('click', e => { if (e.target === mini) openPanel(); });
        closeBtn?.addEventListener('click', closePanel);
        saveBtn?.addEventListener('click', () => {
          localStorage.setItem(CONSENT_KEY, analyticsInput && analyticsInput.checked ? 'all' : 'necessary');
          closePanel();
        });
        acceptAllBtn?.addEventListener('click', () => {
          if (analyticsInput) analyticsInput.checked = true;
          localStorage.setItem(CONSENT_KEY, 'all');
          closePanel();
        });

        // Scroll to Top Button
        const scrollBtn = document.getElementById('scroll-to-top');
        
        // Show/hide button based on scroll position
        window.addEventListener('scroll', () => {
          if (window.scrollY > 300) {
            scrollBtn?.classList.remove('opacity-0', 'pointer-events-none');
            scrollBtn?.classList.add('opacity-100');
          } else {
            scrollBtn?.classList.add('opacity-0', 'pointer-events-none');
            scrollBtn?.classList.remove('opacity-100');
          }
        });
        
        // Scroll to top when clicked
        scrollBtn?.addEventListener('click', () => {
          window.scrollTo({
            top: 0,
            behavior: 'smooth'
          });
        });
      });
    </script>
  </body>
</html>